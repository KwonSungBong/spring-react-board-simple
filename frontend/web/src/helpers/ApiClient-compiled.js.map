{"version":3,"sources":["ApiClient.js"],"names":[],"mappings":"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","file":"ApiClient-compiled.js","sourcesContent":["import superagent from 'superagent';\nimport config from '../config';\n\nconst methods = ['get', 'post', 'put', 'patch', 'del'];\n\nfunction formatUrl(path) {\n\tconst adjustedPath = path[0] !== '/' ? '/' + path : path;\n\n\tif (path.startsWith('http://') || path.startsWith('https://')) {\n\t\treturn path;\n\t}\n\n\tif (__SERVER__) {\n\t\tif(path.startsWith('/auth')){\n\t\t\treturn 'http://' + config.secHost + ':' + config.secPort + adjustedPath.replace('/auth', '');\n\t\t}\n\t\t// Prepend host and port of the API server to the path.\n\t\treturn 'http://' + config.apiHost + ':' + config.apiPort + adjustedPath;\n\t}\n\tif(path.startsWith('/auth')){\n\t\treturn adjustedPath;\n\t}\n\t// Prepend `/api` to relative URL, to proxy to API server.\n\treturn '/api' + adjustedPath;\n}\n\nexport default class ApiClient {\n\tconstructor(req) {\n\t\tmethods.forEach((method) =>\n\t\t\tthis[method] = (path, {params, data, token, authorization, attach} = {}) => new Promise((resolve, reject) => {\n\t\t\t\tconst request = superagent[method](formatUrl(path));\n\n\t\t\t\tif (params) {\n\t\t\t\t\trequest.query(params);\n\t\t\t\t}\n\n\t\t\t\tif (__SERVER__ && req.get('cookie')) {\n\t\t\t\t\trequest.set('cookie', req.get('cookie'));\n\t\t\t\t}\n\n\t\t\t\tif (token) {\n\t\t\t\t\trequest.set('X-XSRF-TOKEN', token);\n\t\t\t\t}\n\n\t\t\t\tif (authorization) {\n\t\t\t\t\trequest.set('authorization', authorization);\n\t\t\t\t}\n\n\t\t\t\tif (attach) {\n\t\t\t\t\tlet formData = new FormData();\n\t\t\t\t\tif(data) {\n\t\t\t\t\t\tformData.append(\"data\", new Blob([JSON.stringify(data)], {type : 'application/json'}));\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (var key in attach) {\n\t\t\t\t\t\t// is the item a File?\n\t\t\t\t\t\tif (attach.hasOwnProperty(key) && attach[key] instanceof File) {\n\t\t\t\t\t\t\tformData.append('file', attach[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trequest.send(formData);\n\n\t\t\t\t} else {\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\trequest.send(data);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*if (data) {\n\t\t\t\t\trequest.send('data', data);\n\t\t\t\t}*/\n\n\t\t\t\trequest.end((err, {body} = {}) => err ? reject(body || err) : resolve(body));\n\t\t\t}));\n\t}\n\n\t/*\n\t * There's a V8 bug where, when using Babel, exporting classes with only\n\t * constructors sometimes fails. Until it's patched, this is a solution to\n\t * \"ApiClient is not defined\" from issue #14.\n\t * https://github.com/erikras/react-redux-universal-hot-example/issues/14\n\t *\n\t * Relevant Babel bug (but they claim it's V8): https://phabricator.babeljs.io/T2455\n\t *\n\t * Remove it at your own risk.\n\t */\n\tempty() {\n\t}\n}\n"]}